{
    "query": "SELECT w.city, \n       COUNT(DISTINCT w.warehouse_id) AS складов,\n       AVG(product_count) AS товаров_на_1_склад\nFROM (\n    SELECT warehouse_id, COUNT(DISTINCT product_id) AS product_count\n    FROM order_line\n    WHERE strftime('%Y-%m', date) = '2020-06'\n    GROUP BY warehouse_id\n) ol\nJOIN warehouses w ON ol.warehouse_id = w.warehouse_id\nGROUP BY w.city;\n",
    "result": [
        {
            "city": "Адлер",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Азов",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Александровск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Алексин",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Ачхой Мартан",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Байкальск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Барнаул",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Батайск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Белореченск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Бийск",
            "складов": 1,
            "товаров_на_1_склад": 4.0
        },
        {
            "city": "Бологое",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Великие Луки",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Верхний Тагил",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Внуково",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Волгоград",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Воткинск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Галич",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Гремячинск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Гусь-Хрустальный",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Дагомыс",
            "складов": 2,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Диксон",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Долинск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Дудинка",
            "складов": 1,
            "товаров_на_1_склад": 3.0
        },
        {
            "city": "Енисейск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Жигулевск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Жуковский",
            "складов": 2,
            "товаров_на_1_склад": 3.5
        },
        {
            "city": "Забайкальск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Заводоуковск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Йошкар-Ола",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Кабанск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Казань",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Кандалакша",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Карабулак",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Каргасок",
            "складов": 1,
            "товаров_на_1_склад": 3.0
        },
        {
            "city": "Кизел",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Кириши",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Киров",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Кировск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Когалым",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Коломна",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Костомукша",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Кострома",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Котельнич",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Краснодар",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Крымск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Курильск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Курск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Люберцы",
            "складов": 2,
            "товаров_на_1_склад": 2.5
        },
        {
            "city": "Магадан",
            "складов": 1,
            "товаров_на_1_склад": 3.0
        },
        {
            "city": "Малгобек",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Махачкала",
            "складов": 1,
            "товаров_на_1_склад": 3.0
        },
        {
            "city": "Мезень",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Меренга",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Можайск",
            "складов": 2,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Можга",
            "складов": 2,
            "товаров_на_1_склад": 2.5
        },
        {
            "city": "Моздок",
            "складов": 1,
            "товаров_на_1_склад": 3.0
        },
        {
            "city": "Мурманск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Невьянск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Нерчинск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Нефтегорск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Нижний Новгород",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Нижний Тагил",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Новороссийск",
            "складов": 2,
            "товаров_на_1_склад": 1.5
        },
        {
            "city": "Новочеркасск",
            "складов": 1,
            "товаров_на_1_склад": 3.0
        },
        {
            "city": "Оймякон",
            "складов": 1,
            "товаров_на_1_склад": 3.0
        },
        {
            "city": "Омск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Петропавловск-Камчатский",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Петушки",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Подольск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Пятигорск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Ревда",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Ростов-на-Дону",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Салехард",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Сарапул",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Северо-Курильск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Североморск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Североуральск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Середниково",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Советский",
            "складов": 1,
            "товаров_на_1_склад": 4.0
        },
        {
            "city": "Соликамск",
            "складов": 1,
            "товаров_на_1_склад": 3.0
        },
        {
            "city": "Сортавала",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Ставрополь",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Тамбей",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Туапсе",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Тырныауз",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Урай",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Уренгой",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Усинск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Усолье Сибирское",
            "складов": 1,
            "товаров_на_1_склад": 3.0
        },
        {
            "city": "Уссурийск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Усть-Ишим",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Усть-Кулом",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Хатанга",
            "складов": 2,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Холмск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Хоста",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Шали",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Шилка",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Щельяюр",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Южно-Курильск",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        },
        {
            "city": "Южноуральск",
            "складов": 1,
            "товаров_на_1_склад": 1.0
        },
        {
            "city": "Яшалта",
            "складов": 1,
            "товаров_на_1_склад": 2.0
        }
    ],
    "error": null
}